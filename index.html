<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portfolio Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #111827; color: #f3f4f6; }
    .card { background: #1f2937; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.5); }
    .muted { color: #d1d5db; }
    .chip { background: rgba(255,255,255,0.1); padding: 0.25rem 0.5rem; border-radius: 999px; font-size: 0.75rem; }
    .chart-img { max-width: 100%; height: auto; border-radius: 8px; }
    .border-card { border: 1px solid rgba(255,255,255,0.2); }
  </style>
</head>
<body class="p-6">
  <div class="max-w-6xl mx-auto">
    <header class="mb-6">
      <h1 class="text-2xl font-semibold">Portfolio Dashboard</h1>
      <p class="text-sm muted">Rendered from provided JSON — interactive, mobile-friendly view.</p>
    </header>

    <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Left Column: Summary + Allocation -->
      <section class="lg:col-span-1 space-y-4">
        <div class="card p-4">
          <h2 class="text-lg font-medium">Summary</h2>
          <p id="summaryText" class="mt-2 text-sm muted"></p>
          <div class="mt-4">
            <h3 class="text-sm font-medium">Allocation</h3>
            <div id="allocationList" class="mt-2 space-y-2 text-sm"></div>
            <div class="mt-3">
              <img id="allocationChart" class="chart-img" alt="Allocation Chart" />
            </div>
          </div>
        </div>

        <div class="card p-4">
          <h2 class="text-lg font-medium">Risk Analysis</h2>
          <div id="riskSummary" class="mt-2 text-sm muted"></div>
          <div class="mt-3">
            <img id="riskChart" class="chart-img" alt="Risk Chart" />
          </div>
        </div>

        <div class="card p-4">
          <h2 class="text-lg font-medium">Education Tips</h2>
          <ul id="educationTips" class="mt-2 text-sm list-disc list-inside muted"></ul>
        </div>
      </section>

      <!-- Middle Column: Stocks + What-if + Mutual Funds + Diversifiers -->
      <section class="lg:col-span-2 space-y-4">
        <div class="card p-4">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-medium">Stocks Selected</h2>
            <span id="equityChip" class="chip">Equity Sleeve</span>
          </div>
          <div id="stocksGrid" class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </div>

        <div class="card p-4">
          <h2 class="text-lg font-medium">What-if Analysis</h2>
          <div id="whatIfText" class="mt-2 text-sm muted"></div>
          <div class="mt-3">
            <img id="whatIfChart" class="chart-img" alt="What-if Chart" />
          </div>
        </div>

        <div class="card p-4">
          <h2 class="text-lg font-medium">Mutual Funds</h2>
          <div id="mfList" class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3"></div>
        </div>

        <div class="card p-4">
          <h2 class="text-lg font-medium">Diversifiers</h2>
          <div id="diversifiersList" class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3"></div>
        </div>
      </section>
    </main>

    <footer class="mt-6 text-sm muted text-center">
      Generated view — charts are loaded from QuickChart / TradingView links present in the JSON.
    </footer>
  </div>

  <!-- Embedded JSON data -->
  <script id="portfolio-data" type="application/json">
    {
  "allocation": {
    "equity_sleeves": {
      "stocks": "40% and $20,000",
      "mutual_funds": "30% and $15,000"
    },
    "diversifiers": {
      "crypto": "5% and $2,500",
      "gold": "10% and $5,000",
      "bond_mutual_funds": "15% and $7,500"
    }
  },
  "chart_url_allocation": "https://quickchart.io/chart?c={type:'pie',data:{labels:['Stocks','Mutual Funds','Gold','Bond Mutual Funds','Crypto'],datasets:[{data:[40,30,10,15,5]}]}}",
  "stocks_selected": [
    {
      "stock": "MSFT",
      "current_price": 510.96,
      "week_52_high": "555.45",
      "week_52_low": "344.79",
      "pe": "37.30",
      "pb": "11.06",
      "eps": "13.64",
      "roe": "N/A",
      "roa": "N/A",
      "dividend_yield": "0.63",
      "total_debt_to_equity": "0.26",
      "revenue_growth_yoy": "14.93",
      "net_profit_margin": "36.15",
      "current_ratio": "1.35",
      "chart": "Chart URL unavailable from tool.",
      "buy_link": "https://public.com/stocks/MSFT",
      "analysis_summary": {
        "reason_for_selection(2-3 lines)": "Microsoft demonstrates strong revenue growth and a high net profit margin, indicating excellent profitability. It's a reliable choice for long-term growth in a moderate risk portfolio due to its diversified business model."
      }
    },
    {
      "stock": "GOOGL",
      "current_price": 236.57,
      "week_52_high": "256.00",
      "week_52_low": "140.53",
      "pe": "24.79",
      "pb": "7.89",
      "eps": "9.25",
      "roe": "N/A",
      "roa": "N/A",
      "dividend_yield": "0.34",
      "total_debt_to_equity": "0.04",
      "revenue_growth_yoy": "13.13",
      "net_profit_margin": "31.12",
      "current_ratio": "1.84",
      "chart": "Chart URL unavailable from tool.",
      "buy_link": "https://public.com/stocks/GOOGL",
      "analysis_summary": {
        "reason_for_selection(2-3 lines)": "Google (Alphabet) has a healthy balance sheet with low debt and strong profitability. Its consistent revenue growth and diversified segments make it a stable yet growth-oriented investment for a moderate risk profile."
      }
    },
    {
      "stock": "AAPL",
      "current_price": 245.27,
      "week_52_high": "260.10",
      "week_52_low": "169.21",
      "pe": "36.66",
      "pb": "55.29",
      "eps": "6.58",
      "roe": "N/A",
      "roa": "N/A",
      "dividend_yield": "0.42",
      "total_debt_to_equity": "1.89",
      "revenue_growth_yoy": "5.97",
      "net_profit_margin": "24.30",
      "current_ratio": "0.83",
      "chart": "Chart URL unavailable from tool.",
      "buy_link": "https://public.com/stocks/AAPL",
      "analysis_summary": {
        "reason_for_selection(2-3 lines)": "Apple is a global leader in consumer technology with consistent brand loyalty and strong profit margins. While its PE is a bit higher, its innovation and market position suggest continued growth and stability, suitable for a moderate portfolio."
      }
    },
    {
      "stock": "JPM",
      "current_price": 300.89,
      "week_52_high": "318.01",
      "week_52_low": "202.16",
      "pe": "14.64",
      "pb": "2.32",
      "eps": "19.98",
      "roe": "N/A",
      "roa": "N/A",
      "dividend_yield": "1.88",
      "total_debt_to_equity": "2.09",
      "revenue_growth_yoy": "108.98",
      "net_profit_margin": "33.26",
      "current_ratio": "NULL",
      "chart": "Chart URL unavailable from tool.",
      "buy_link": "https://public.com/stocks/JPM",
      "analysis_summary": {
        "reason_for_selection(2-3 lines)": "JPMorgan Chase offers exposure to the financial sector with exceptional year-over-year revenue growth and a strong net profit margin. Its lower PE ratio compared to tech giants provides a value aspect, balancing the portfolio's risk."
      }
    }
  ],
  "mutual_funds_selected": [
    {
      "name": "N/A",
      "category": "Diversified Equity Mutual Fund (Recommended)",
      "3_year_return": "N/A",
      "5_year_return": "N/A",
      "reason_for_investment": "No mutual funds could be selected as the 'mutual_funds_metrics' table is currently unavailable. Please consider diversified equity mutual funds from other sources for your allocation to ensure proper diversification within the equity sleeve for a moderate risk profile."
    }
  ],
  "crypto_selected": [
    {
      "id": "bitcoin",
      "name": "Bitcoin",
      "symbol": "btc",
      "current_price": 10139978,
      "roi": "N/A",
      "buy_link": "https://www.coinbase.com/price/bitcoin",
      "summary": "Bitcoin is included as a high-growth, albeit volatile, asset to capture potential upside within the diversification sleeve. Its limited supply and increasing institutional adoption make it a unique digital asset."
    }
  ],
  "bond_mutual_funds": {
    "summary": "Fixed deposit/debt (categorized here as bond mutual funds for broader market instrument context) provides stability and capital preservation, acting as a crucial diversifier to mitigate overall portfolio volatility and generate steady income for a moderate risk profile."
  },
  "Gold": {
    "summary": "Gold serves as a traditional safe-haven asset, offering protection against inflation and market downturns. Its inclusion enhances portfolio stability and acts as a store of value, suitable for a moderate risk allocation."
  },
  "what_if_analysis": {
    "conservative_return": "5% return: $2,500 gain, total value $52,500",
    "moderate_return": "8% return: $4,000 gain, total value $54,000",
    "optimistic_return": "12% return: $6,000 gain, total value $56,000",
    "quickchart_url": "https://quickchart.io/chart?c={type:'bar',data:{labels:['Conservative (5%)','Moderate (8%)','Optimistic (12%)'],datasets:[{label:'Projected Value',data:[52500,54000,56000],backgroundColor:['#4CAF50','#FFC107','#2196F3']}]}}"
  },
  "summary": "This portfolio of $50,000, managed over 5 years with a moderate risk appetite, is designed for balanced growth and risk management. It allocates 70% to equity (40% stocks, 30% mutual funds) and 30% to diversifiers (10% gold, 15% bond mutual funds/fixed deposit, 5% crypto). The selected stocks (MSFT, GOOGL, AAPL, JPM) offer a blend of growth and stability across technology and financial sectors. While specific mutual funds could not be recommended due to data limitations, their importance for diversification within the equity sleeve is highlighted. The inclusion of gold and bond mutual funds aims to stabilize the portfolio, while a small allocation to crypto provides exposure to high-growth potential. The portfolio aims for consistent returns while managing downside risk, aligning well with a moderate risk profile.",
  "risk_analysis": {
    "mild_crash": "10% drop: $5,000 lost, portfolio value $45,000",
    "moderate_crash": "20% drop: $10,000 lost, portfolio value $40,000",
    "severe_crash": "30% drop: $15,000 lost, portfolio value $35,000",
    "summary": "A moderate risk portfolio acknowledges market fluctuations. This analysis shows the potential impact of various market downturns. Diversification across different asset classes (stocks, mutual funds, gold, bonds, crypto) is key to cushioning these impacts. Regular rebalancing and a long-term perspective are vital to navigate such events, ensuring the portfolio remains aligned with your risk tolerance and financial goals.",
    "quickchart_url": "https://quickchart.io/chart?c={type:'bar',data:{labels:['Mild Crash (10%)','Moderate Crash (20%)','Severe Crash (30%)'],datasets:[{label:'Portfolio Value After Crash',data:[45000,40000,35000],backgroundColor:['#FFEB3B','#FF9800','#F44336']}]}}"
  },
  "education_tips": {
    "diversification_importance": "Diversification spreads your investments across different asset classes, industries, and geographies. This strategy helps reduce overall portfolio risk because if one investment performs poorly, others may perform well, balancing the impact. It's a cornerstone of prudent investing.",
    "long_term_perspective": "Investing with a long-term mindset allows your investments more time to recover from market downturns and benefit from compounding returns. Short-term market volatility is normal; focusing on your long-term financial goals helps you avoid emotional decisions.",
    "rebalancing_strategy": "Rebalancing involves adjusting your portfolio periodically to maintain your target asset allocation. For example, if stocks have performed very well and now represent a larger portion of your portfolio than intended, you would sell some stocks and buy more of your underperforming assets (like bonds) to return to your desired allocation. This helps manage risk and ensures you're not overly exposed to any single asset class.",
    "understanding_risk": "Understanding your personal risk tolerance is crucial. Risk isn't just about losing money; it's about the volatility and potential for returns. A higher-risk portfolio might offer higher potential returns but also greater potential losses. A lower-risk portfolio offers more stability but potentially lower returns. Ensure your investments align with your comfort level for market fluctuations."
  }
}
  </script>

  <script>
    const data = JSON.parse(document.getElementById('portfolio-data').textContent.trim());

    // Summary
    document.getElementById('summaryText').textContent = data.summary;

    // Allocation
    const alloc = data.allocation;
    const allocEl = document.getElementById('allocationList');
    allocEl.innerHTML = `
      <div><strong>Stocks:</strong> ${alloc.equity_sleeves.stocks}</div>
      <div><strong>Mutual Funds:</strong> ${alloc.equity_sleeves.mutual_funds}</div>
      <div><strong>Crypto:</strong> ${alloc.diversifiers.crypto || '0%'}</div>
      <div><strong>Bond MF:</strong> ${alloc.diversifiers.bond_mutual_funds}</div>
      <div><strong>Gold:</strong> ${alloc.diversifiers.gold}</div>
    `;

    // Allocation chart
    document.getElementById('allocationChart').src = data.chart_url_allocation;

    // Risk analysis
    document.getElementById('riskSummary').textContent = data.risk_analysis.summary;
    document.getElementById('riskChart').src = data.risk_analysis.quickchart_url;

    // What-if analysis
    const whatIf = data.what_if_analysis;
    document.getElementById('whatIfText').innerHTML = `
      <div class="text-sm muted"><strong>Conservative:</strong> ${whatIf.conservative_return || ''}</div>
      <div class="text-sm muted"><strong>Moderate:</strong> ${whatIf.moderate_return || ''}</div>
      <div class="text-sm muted"><strong>Optimistic:</strong> ${whatIf.optimistic_return || ''}</div>
    `;
    document.getElementById('whatIfChart').src = whatIf.quickchart_url || '';

    // Education tips
    const tipsEl = document.getElementById('educationTips');
    tipsEl.innerHTML = '';
    for (const tip of Object.values(data.education_tips)) {
      const li = document.createElement('li');
      li.textContent = tip;
      tipsEl.appendChild(li);
    }

    // Stocks grid
    const stocksGrid = document.getElementById('stocksGrid');
    stocksGrid.innerHTML = '';
    (data.stocks_selected || []).forEach(s => {
      const card = document.createElement('div');
      card.className = 'p-4 card';
      card.innerHTML = `
        <div class="flex items-start justify-between">
          <div>
            <h3 class="text-md font-semibold">${s.stock}</h3>
            <div class="muted text-sm">Price: ${s.current_price}</div>
            <div class="muted text-sm">PE: ${s.pe} • PB: ${s.pb}</div>
          </div>
          <div class="text-right">
            <a href="${s.buy_link || '#'}" target="_blank" class="text-sm underline">Buy</a>
          </div>
        </div>
        <p class="mt-2 text-sm muted">${s.analysis_summary?.['reason_for_selection(2-3 lines)'] || ''}</p>
        <div class="mt-3">
          <img src="${s.chart}" alt="${s.stock} chart" class="chart-img" />
        </div>
        <div class="mt-3 text-sm muted grid grid-cols-2 gap-2">
          <div><strong>52w High:</strong> ${s.week_52_high || 'N/A'}</div>
          <div><strong>52w Low:</strong> ${s.week_52_low || 'N/A'}</div>
          <div><strong>Dividend:</strong> ${s.dividend_yield || 'N/A'}</div>
          <div><strong>Debt/Equity:</strong> ${s.total_debt_to_equity || 'N/A'}</div>
        </div>
      `;
      stocksGrid.appendChild(card);
    });

    // Mutual funds
    const mfList = document.getElementById('mfList');
    mfList.innerHTML = '';
    (data.mutual_funds_selected || []).forEach(m => {
      const el = document.createElement('div');
      el.className = 'p-3 border-card rounded';
      el.innerHTML = `
        <div class="text-sm font-medium">${m.name}</div>
        <div class="muted text-xs">${m.category} • 3y: ${m['3_year_return']} • 5y: ${m['5_year_return']}</div>
        <div class="mt-2 text-sm muted">${m.reason_for_investment}</div>
      `;
      mfList.appendChild(el);
    });

    // Diversifiers (Crypto, Gold, Bond MF)
    const diversifiersEl = document.getElementById('diversifiersList');
    diversifiersEl.innerHTML = '';

    // --- Crypto ---
    (data.crypto_selected || []).forEach(c => {
      const el = document.createElement('div');
      el.className = 'p-3 border-card rounded';
      el.innerHTML = `
        <div class="flex justify-between items-center">
          <div>
            <div class="text-sm font-medium">${c.name} (${c.symbol.toUpperCase()})</div>
            <div class="muted text-xs">Price: ${c.current_price.toLocaleString()} USD</div>
          </div>
          <a href="${c.buy_link}" target="_blank" class="text-xs underline">Buy</a>
        </div>
        <div class="mt-2 text-sm muted">ROI: ${c.roi || 'N/A'}</div>
      `;
      diversifiersEl.appendChild(el);
    });

    // --- Gold ---
    if (data.allocation.diversifiers.gold) {
      const goldEl = document.createElement('div');
      goldEl.className = 'p-3 border-card rounded';
      goldEl.innerHTML = `
        <div class="text-sm font-medium">Gold</div>
        <div class="muted text-xs">Allocation: ${data.allocation.diversifiers.gold}</div>
      `;
      diversifiersEl.appendChild(goldEl);
    }

    // --- Bond Mutual Funds ---
    if (data.allocation.diversifiers.bond_mutual_funds) {
      const bondEl = document.createElement('div');
      bondEl.className = 'p-3 border-card rounded';
      bondEl.innerHTML = `
        <div class="text-sm font-medium">Bond Mutual Funds</div>
        <div class="muted text-xs">Allocation: ${data.allocation.diversifiers.bond_mutual_funds}</div>
      `;
      diversifiersEl.appendChild(bondEl);
    }
  </script>
</body>
</html>
